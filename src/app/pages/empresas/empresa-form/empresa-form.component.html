<div class="container">
  <div class="header">
    <h1>{{ isEditMode() ? 'Editar Empresa' : 'Nueva Empresa' }}</h1>
    <a routerLink="/empresas" class="btn btn-secondary">← Volver</a>
  </div>

  @if (error()) {
    <div class="error-message">{{ error() }}</div>
  }

  <div class="form-container">
    <form [formGroup]="empresaForm" (ngSubmit)="onSubmit()">
      <!-- Sección: Datos de la Empresa -->
      <div class="section">
        <h2 class="section-title">Datos de la Empresa</h2>

        <div class="form-group">
          <label for="nombre">Nombre de la Empresa *</label>
          <input
            type="text"
            id="nombre"
            formControlName="nombre"
            [class.error]="hasError('nombre')"
            placeholder="Ingrese el nombre"
          />
          @if (hasError('nombre')) {
            <span class="error-text">{{ getErrorMessage('nombre') }}</span>
          }
        </div>

        <div class="form-group">
          <label for="nit">NIT *</label>
          <input
            type="text"
            id="nit"
            formControlName="nit"
            [class.error]="hasError('nit')"
            placeholder="Ingrese el NIT"
            maxlength="30"
          />
          @if (hasError('nit')) {
            <span class="error-text">{{ getErrorMessage('nit') }}</span>
          }
        </div>

        <div class="form-group">
          <label for="correo">Correo Electrónico *</label>
          <input
            type="email"
            id="correo"
            formControlName="correo"
            [class.error]="hasError('correo')"
            placeholder="ejemplo@correo.com"
          />
          @if (hasError('correo')) {
            <span class="error-text">{{ getErrorMessage('correo') }}</span>
          }
        </div>
      </div>

      <!-- Sección: Datos del Administrador (solo en modo creación) -->
      @if (!isEditMode()) {
        <div class="section">
          <h2 class="section-title">Datos del Administrador</h2>
          <p class="section-description">
            Se creará un usuario administrador para esta empresa
          </p>

          <div class="form-group">
            <label for="nombreAdmin">Nombre del Administrador *</label>
            <input
              type="text"
              id="nombreAdmin"
              formControlName="nombreAdmin"
              [class.error]="hasError('nombreAdmin')"
              placeholder="Ej: Juan"
            />
            @if (hasError('nombreAdmin')) {
              <span class="error-text">{{ getErrorMessage('nombreAdmin') }}</span>
            }
          </div>

          <div class="form-group">
            <label for="apellidoAdmin">Apellido del Administrador *</label>
            <input
              type="text"
              id="apellidoAdmin"
              formControlName="apellidoAdmin"
              [class.error]="hasError('apellidoAdmin')"
              placeholder="Ej: Pérez"
            />
            @if (hasError('apellidoAdmin')) {
              <span class="error-text">{{ getErrorMessage('apellidoAdmin') }}</span>
            }
          </div>

          <div class="form-group">
            <label for="correoAdmin">Correo del Administrador *</label>
            <input
              type="email"
              id="correoAdmin"
              formControlName="correoAdmin"
              [class.error]="hasError('correoAdmin')"
              placeholder="admin@correo.com"
            />
            @if (hasError('correoAdmin')) {
              <span class="error-text">{{ getErrorMessage('correoAdmin') }}</span>
            }
          </div>

          <div class="form-group">
            <label for="passwordAdmin">Contraseña *</label>
            <input
              type="password"
              id="passwordAdmin"
              formControlName="passwordAdmin"
              [class.error]="hasError('passwordAdmin')"
              placeholder="Mínimo 6 caracteres"
            />
            @if (hasError('passwordAdmin')) {
              <span class="error-text">{{ getErrorMessage('passwordAdmin') }}</span>
            }
          </div>
        </div>
      }

      <div class="form-actions">
        <button type="button" routerLink="/empresas" class="btn btn-secondary">
          Cancelar
        </button>
        <button type="submit" class="btn btn-primary" [disabled]="loading()">
          {{ loading() ? 'Guardando...' : (isEditMode() ? 'Actualizar' : 'Crear Empresa') }}
        </button>
      </div>
    </form>
  </div>
</div>
