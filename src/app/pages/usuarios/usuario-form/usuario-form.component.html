<div class="container">
  <div class="header">
    <h1>{{ isEditMode() ? 'Editar Usuario' : 'Nuevo Usuario' }}</h1>
    <a routerLink="/usuarios" class="btn btn-secondary">‚Üê Volver</a>
  </div>

  @if (error()) {
    <div class="error-message">{{ error() }}</div>
  }

  <div class="form-container">
    <form [formGroup]="usuarioForm" (ngSubmit)="onSubmit()">
      <div class="form-row">
        <div class="form-group">
          <label for="nombre">Nombre *</label>
          <input
            type="text"
            id="nombre"
            formControlName="nombre"
            [class.error]="hasError('nombre')"
            placeholder="Ingrese el nombre"
          />
          @if (hasError('nombre')) {
            <span class="error-text">{{ getErrorMessage('nombre') }}</span>
          }
        </div>

        <div class="form-group">
          <label for="apellido">Apellido *</label>
          <input
            type="text"
            id="apellido"
            formControlName="apellido"
            [class.error]="hasError('apellido')"
            placeholder="Ingrese el apellido"
          />
          @if (hasError('apellido')) {
            <span class="error-text">{{ getErrorMessage('apellido') }}</span>
          }
        </div>
      </div>

      <div class="form-group">
        <label for="correo">Correo Electr√≥nico *</label>
        <input
          type="email"
          id="correo"
          formControlName="correo"
          [class.error]="hasError('correo')"
          placeholder="ejemplo@correo.com"
        />
        @if (hasError('correo')) {
          <span class="error-text">{{ getErrorMessage('correo') }}</span>
        }
      </div>

      <div class="form-group">
        <label for="password">
          Contrase√±a {{ isEditMode() ? '(dejar vac√≠o si no desea cambiarla)' : '*' }}
        </label>
        <div class="password-container">
          <input
            [type]="showPassword() ? 'text' : 'password'"
            id="password"
            formControlName="password"
            [class.error]="hasError('password')"
            placeholder="Ingrese la contrase√±a"
          />
          <button
            type="button"
            class="toggle-password"
            (click)="togglePasswordVisibility()">
            {{ showPassword() ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è' }}
          </button>
        </div>
        @if (hasError('password')) {
          <span class="error-text">{{ getErrorMessage('password') }}</span>
        }
      </div>

      <div class="form-group checkbox-group">
        <label class="checkbox-label">
          <input
            type="checkbox"
            formControlName="activo"
          />
          <span>Usuario activo</span>
        </label>
        <small>Los usuarios inactivos no podr√°n acceder al sistema</small>
      </div>

      <div class="form-actions">
        <button type="button" routerLink="/usuarios" class="btn btn-secondary">
          Cancelar
        </button>
        <button type="submit" class="btn btn-primary" [disabled]="loading()">
          {{ loading() ? 'Guardando...' : (isEditMode() ? 'Actualizar' : 'Crear') }}
        </button>
      </div>
    </form>
  </div>
</div>
